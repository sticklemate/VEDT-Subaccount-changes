var emble={rce:{contextMenuManager:{rect:{pointer:18},menuItem:[]},undoManager:{},customiseManager:{customiseItem:[],customiseItemPageID:"customise-options"},deleteManager:{}},ui:{setting:{namespace:"emble",quick_add:{enabled:!0,block_category:[]},default_view_emble:!0}},database:{course_id:59613,filtered_block_category:[],block_category:[],help_pages:["help-emble","help-quick-add","help-default-view"],help_instruction:[]},canvas_api:{}};function initEmble(){emble.canvas_api.getEmbleSetting().then(function(e){emble.ui.setting=e},function(e){emble.canvas_api.putEmbleSetting(emble.ui.setting).then(function(e){})}).then(function(){for(var e=emble.database.help_pages,t=0;t<e.length;t++){var n="https://rmit.instructure.com/api/v1/courses/"+emble.database.course_id+"/pages/"+e[t];emble.canvas_api.getItemData(n).then(function(e){e&&emble.database.help_instruction.push({page_id:e.url,html:e.body})})}emble.ui.displayInterface().then(function(e){emble.ui.toggleEmbleInterfaceMenu(),emble.ui.handleHelpBtn(),$("#emble-interface").on("keyup",'.personalise-option-wrapper input[type="text"]',function(e){e.preventDefault(),emble.ui.blockSearch(this.value.trim()).then(function(e){e&&emble.ui.displayBlockOptions(emble.database.filtered_block_category)})})})}),emble.database.getBlocks(emble.database.course_id).then(function(e){e&&emble.ui.displayBlockOptions(emble.database.block_category).then(function(e){e&&(emble.ui.toggleBlockCategory(),emble.ui.selectBlockOption())})}),emble.rce.getActiveEditor().then(function(e){if(e){emble.rce.activeEditor;emble.rce.undoManager.displayBtn(),$(emble.rce.activeEditor.iframeElement).css({"min-height":"450px"}),$(document).off("keydown"),emble.rce.insertCSStoRCE().then(function(e){emble.rce.editorEvent(),emble.rce.hoverIndicator()})}})}emble.canvas_api.deleteEmbleSetting=function(){var e=emble.ui.setting.namespace,a={ns:e};return new Promise(function(n,t){$.ajax({url:"/api/v1/users/self/custom_data/"+e,type:"DELETE",data:a}).fail(function(e){t(e)}).done(function(e){var t=JSON.parse(e.data);n(t)})})},emble.canvas_api.getEmbleSetting=function(){var e=emble.ui.setting.namespace,a={ns:e};return new Promise(function(n,t){$.ajax({url:"/api/v1/users/self/custom_data/"+e,type:"GET",data:a}).fail(function(e){t(e)}).done(function(e){var t=JSON.parse(e.data);n(t)})})},emble.canvas_api.getItemData=function(e){return new Promise(function(t,n){$.ajax({url:e}).fail(function(e){n(e)}).done(function(e){t(e)})})},emble.canvas_api.getModules=function(e){return new Promise(function(t,n){$.ajax({url:"/api/v1/courses/"+e+"/modules?include[]=items&per_page=100"}).fail(function(e){n(e)}).done(function(e){t(e)})})},emble.canvas_api.putEmbleSetting=function(e){var t=JSON.stringify(e),a=emble.ui.setting.namespace,o={ns:a,data:t};return new Promise(function(t,n){$.ajax({url:"/api/v1/users/self/custom_data/"+a,type:"PUT",data:o}).done(function(e){t(e)}).fail(function(e){n(e)})})},emble.database.getBlocks=function(t){return new Promise(function(l,e){var r=0,s=0;emble.canvas_api.getModules(t).then(function(e){for(var t=0;t<e.length;t++){var n={name:e[t].name,id:e[t].id,block:[]};r+=e[t].items.length;for(var a=e[t].items,o=0;o<a.length;o++){var i={name:a[o].title,html:"",example_link:"",module_id:e[t].id,id:a[o].page_url,instruction:""};i.name.match(/instruction/gi)||n.block.push(i),o==a.length-1&&emble.database.block_category.push(n);var c=a[o].url;emble.canvas_api.getItemData(c).then(function(e){for(var t=emble.database.block_category,n=0;n<t.length;n++)for(var a=t[n].block,o=0;o<a.length;o++){if(e.url==a[o].id){a[o].html=e.body,a[o].example_link=e.html_url;break}if(e.url==a[o].id+"-instructions"||e.url==a[o].id+"-instruction"){a[o].instruction=e.body;break}}(s+=1)==r&&l(!0)})}}})})},emble.rce.editingIndicator=function(){var e=emble.rce.activeEditor,t=e.selection.getNode(),n=e.dom.getParents(t,"*[data-edit-indicator]");$(t).is("*[data-edit-indicator]")||n.length?($(t).is("*[data-edit-indicator]")?emble_option_el=t:emble_option_el=n[0],$(e.dom.select("*[data-edit-indicator]")).attr("data-edit-indicator",!1),$(emble_option_el).attr("data-edit-indicator",!0)):$(e.dom.select("*[data-edit-indicator]")).attr("data-edit-indicator",!1)},emble.rce.editorEvent=function(){var e=emble.rce.activeEditor;e.on("click",function(e){emble.rce.editingIndicator();var t=emble.rce.activeEditor.selection.getNode();emble.rce.contextMenuManager.displayContextMenu(t)}),e.on("keyup",function(e){var t=e.which||e.keyCode||e.charCode;if(8==t||46==t||13==t||37==t||38==t||39==t||40==t){emble.rce.editingIndicator();var n=emble.rce.activeEditor.selection.getNode();emble.rce.contextMenuManager.displayContextMenu(n)}}),e.on("NodeChange",function(e){var t=emble.rce.activeEditor;emble.rce.undoManager.updateBtnState(),emble.rce.removeHighlightIndicator(600),$(t.dom.select(".video-container")).each(function(){if($(this).find("iframe").length){$(this).removeClass("no-video");var e=$(this).find("iframe");$(e).attr("src").match(/(external_tools).{1,}(rmit-arc.instructuremedia.com)/gi)&&!$(e).attr("src").match(/(bare_embed)/gi)&&$(this).addClass("arc-comment")}else $(this).addClass("no-video")}),emble.rce.hoverIndicator()})},emble.rce.generateUUID=function(){return"xxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},emble.rce.getActiveEditor=function(){return new Promise(function(t,n){var a=setInterval(function(){var e=0;"undefined"!=typeof tinymce&&tinymce.hasOwnProperty("activeEditor")&&tinymce.activeEditor?(emble.rce.activeEditor=tinymce.activeEditor,t(!0),clearInterval(a)):200==e?(n(!1),clearInterval(a)):e+=1},250)})},emble.rce.hoverIndicator=function(){var e=emble.rce.activeEditor;$(e.dom.select("#tinymce")).on("mouseover mouseout","[data-context-menu]",function(e){e.stopPropagation(),"mouseover"==e.type?$(this).addClass("hover"):$(this).removeClass("hover")})},emble.rce.insertBlockContent=function(e){var t=e.block_html,n=e.block_id,a=(e.block_name,e.category_name);emble.rce.activeEditor.insertContent('<div class="highlight-insert-indicator">'+t+"</div>");var o=emble.ui.setting.quick_add.block_category;if(0<o.length)for(var i=0;i<o.length;i++){var c=o[i].name;if(a==c)for(var l=o[i].block,r=0;r<l.length&&n!=l[r];r++)r==l.length-1&&n!=l[r]&&(o[i].block.push(n),emble.canvas_api.putEmbleSetting(emble.ui.setting),emble.ui.displayQuickAddOptions());else i==o.length-1&&a!=c&&(emble.ui.setting.quick_add.block_category.push({name:a,block:[n]}),emble.canvas_api.putEmbleSetting(emble.ui.setting),emble.ui.displayQuickAddOptions())}else emble.ui.setting.quick_add.block_category.push({name:a,block:[n]}),emble.canvas_api.putEmbleSetting(emble.ui.setting),emble.ui.displayQuickAddOptions();emble.rce.removeHighlightIndicator(600)},emble.rce.insertCSStoRCE=function(){return new Promise(function(e,t){var n="";$("link").each(function(){($(this).attr("href").match(/(instructure-uploads).{1,}(.css)$/gi)||$(this).attr("href").match(/(brandable_css).{1,}(common).{1,}(.css)$/gi))&&"stylesheet"==$(this).attr("rel")&&(n+=$(this).attr("href")+",")}),n=n.slice(0,-1),emble.rce.activeEditor.dom.loadCSS(n),e(!0)})},emble.rce.removeHighlightIndicator=function(e){emble.rce.activeEditor.dom.select(".highlight-insert-indicator").length&&setTimeout(function(){if(emble.rce.activeEditor.dom.select(".highlight-insert-indicator").length){var e=emble.rce.activeEditor.dom.select(".highlight-insert-indicator")[0],t=e.innerHTML;emble.rce.activeEditor.selection.select(e),emble.rce.activeEditor.selection.setContent(t)}},e)},emble.ui.blockSearch=function(l){return new Promise(function(e,t){var n=JSON.parse(JSON.stringify(emble.database.block_category));if(l.length){for(var a=new RegExp("\\b"+l,"gi"),o=n.length-1;0<=o;o--){for(var i=n[o].block,c=i.length-1;0<=c;c--)i[c].name.match(a)||i.splice(c,1);0==i.length&&n.splice(o,1)}e(emble.database.filtered_block_category=n)}else emble.database.filtered_block_category=n,e(!0)})},emble.ui.displayBlockOptions=function(c){return new Promise(function(e,t){for(var n="",a=0;a<c.length;a++){n+='<div id="category-'+a+'" class="block-category expanded">',n+='<div class="category-title"><p>'+c[a].name+'</p><i class="icon icon-arrow-open-up"></i></div>',n+='<div class="category-options">',n+='<div class="category-padding">';for(var o=c[a].block,i=0;i<o.length;i++)n+='<div class="block-options" data-block-id="'+o[i].id+'" data-category-name="'+c[a].name+'" data-block-name="'+o[i].name+'">',n+="<p>"+o[i].name+"</p>",n+='<button><i class="icon-question"></i></button>',n+="</div>";n+="</div>",n+="</div>",n+="</div>",a==c.length-1&&($("#emble-category").html(n),emble.ui.displayQuickAddOptions(),e(!0))}})},emble.ui.displayDialog=function(e,t,n,a,o){var i='<div class="modal-container"><div style="background-color: rgba(0, 0, 0, 0.5);" class="ReactModal__Overlay ReactModal__Overlay--after-open ReactModal__Overlay--canvas"><div  class="ReactModal__Content ReactModal__Content--after-open ReactModal__Content--canvas"><div class="ReactModal__Layout"><div class="ReactModal__Header"><div class="ReactModal__Header-Title"><h4>'+e+'</h4></div><div class="ReactModal__Header-Actions"><button class="modal-cancel-btn Button Button--icon-action" type="button"><i class="icon-x" ></i><span class="screenreader-only">Close</span></button></div></div>';i+='<div class="ReactModal__Body">'+t+"</div>",i+='<div class="ReactModal__Footer"><div class="ReactModal__Footer-Actions"><button type="button" class="btn btn-default modal-cancel-btn">Cancel</button><button type="submit" class="btn btn-primary modal-action-btn">'+n+"</button></div></div></div></div></div></div>",$("body").append(i),$(".modal-container .modal-cancel-btn").off("click"),$(".modal-container .modal-cancel-btn").on("click",function(e){e.preventDefault(),$(".modal-container").remove()}),$(".modal-container .modal-action-btn").off("click"),$(".modal-container .modal-action-btn").on("click",function(e){e.preventDefault(),o?a(o):a(),$(".modal-container").remove()})},emble.ui.displayInterface=function(){return new Promise(function(e,t){$("#left-side #emble-interface").length||($("#left-side").prepend('<a id="toggle-emble" href="#" data-show-emble="true" style="margin-left: 12px;display: inline-block; white-space: nowrap; margin-bottom: 10px;">Switch to course menu</a>'),$("#left-side").append('<div id="emble-interface"><h4>Emble <i class="icon-question get-help" style="vertical-align: middle;" data-help="help-emble"></i></h4><div class="personalise-option-wrapper"> <label class="ic-Super-toggle--on-off" for="emble-interface-default-toggle"> <p>Show Emble by default</p> <i class="icon-question get-help" style="vertical-align: middle;" data-help="help-default-view"></i><input type="checkbox" id="emble-interface-default-toggle" class="ic-Super-toggle__input"> <div class="ic-Super-toggle__container" aria-hidden="true" data-checked="On" data-unchecked="Off"> <div class="ic-Super-toggle__switch"></div></div></label><input type="text" placeholder="Search" style="width: 170px;margin-top: 15px;" /></div><div id="emble-category"></div></div>'),$("#quick-add-toggle").prop("checked",emble.ui.setting.quick_add.enabled),$("#emble-interface-default-toggle").prop("checked",emble.ui.setting.default_view_emble)),emble.ui.setting.default_view_emble?($("#toggle-emble").attr("data-show-emble",!0),$("#toggle-emble").text("Switch to course menu"),$("#left-side nav").toggle()):($("#toggle-emble").attr("data-show-emble",!1),$("#toggle-emble").text("Switch to Emble"),$("#left-side #emble-interface").toggle()),e(!0)})},emble.ui.displayQuickAddOptions=function(){if(emble.ui.setting.quick_add.enabled){var e=emble.ui.setting.quick_add.block_category;if(0<e.length)for(var t=0;t<e.length;t++)for(var n=e[t].name,a=e[t].block,o=0;o<a.length;o++)$('.block-options[data-block-id="'+a[o]+'"][data-category-name="'+n+'"] button').show()}else $(".block-options").removeClass("quick-add")},emble.ui.handleHelpBtn=function(){$("#emble-interface").on("click",".icon-question.get-help",function(e){e.preventDefault();for(var t=$(this).attr("data-help"),n=function(){$(".modal-container").remove()},a=emble.database.help_instruction,o=0;o<a.length;o++)if(t==a[o].page_id){emble.ui.displayDialog("Emble",a[o].html,"Got it",n,"");break}})},emble.ui.selectBlockOption=function(){function r(e,t,n,a){var o=emble.rce.insertBlockContent;emble.ui.displayDialog(e+": "+t,n,"Add to page",o,a)}function s(e,t){for(var n=emble.database.block_category,a=0;a<n.length;a++)for(var o=n[a].block,i=0;i<o.length;i++){if(e==o[i].id)return{block_html:o[i].html,block_id:o[i].id,block_name:o[i].name,block_instruction:o[i].instruction,category_name:t};if(e!=o[i].id&&i==o.length-1&&a==n.length-1)return!1}}$("#emble-interface").on("click",".block-options p",function(){var e=$(this).parent().attr("data-block-id"),t=$(this).parent().attr("data-category-name"),n=s(e,t);if(n)if(emble.ui.setting.quick_add.enabled){var a=emble.ui.setting.quick_add.block_category;if(0<a.length)e:for(var o=0;o<a.length;o++){var i=a[o].name;if(t==i)for(var c=a[o].block,l=0;l<c.length;l++){if(e==c[l]){emble.rce.insertBlockContent(n);break e}l==c.length-1&&o==a.length-1&&e!=c[l]&&r(t,n.block_name,n.block_instruction,n)}else o==a.length-1&&t!=i&&r(t,n.block_name,n.block_instruction,n)}else r(t,n.block_name,n.block_instruction,n)}else r(t,n.block_name,n.block_instruction,n)}),$("#emble-interface").on("click",".block-options button",function(){var e=$(this).parent().attr("data-block-id"),t=$(this).parent().attr("data-category-name"),n=s(e,t);n&&r(t,n.block_name,n.block_instruction,n)})},emble.ui.toggleBlockCategory=function(){$("#emble-interface").on("click",".category-title",function(){$(this).parent().hasClass("expanded")?($(this).parent().removeClass("expanded"),$(this).children("i").removeClass("icon-arrow-open-up"),$(this).children("i").addClass("icon-arrow-open-down")):($(this).parent().addClass("expanded"),$(this).children("i").addClass("icon-arrow-open-up"),$(this).children("i").removeClass("icon-arrow-open-down"))})},emble.ui.toggleEmbleInterfaceMenu=function(){function t(){"block"==$("#left-side #emble-interface").css("display")?($("#toggle-emble").attr("data-show-emble",!0),$("#toggle-emble").text("Switch to course menu")):($("#toggle-emble").attr("data-show-emble",!1),$("#toggle-emble").text("Switch to Emble"))}$("#courseMenuToggle").on("click",function(e){e.stopPropagation(),$("#left-side nav").toggle(),$("#left-side #emble-interface").toggle(),t()}),$("#toggle-emble").on("click",function(e){e.preventDefault(),$("#left-side nav").toggle(),$("#left-side #emble-interface").toggle(),t()}),$("#quick-add-toggle").on("change",function(e){emble.ui.setting.quick_add.enabled=$(this).prop("checked"),emble.canvas_api.putEmbleSetting(emble.ui.setting),emble.ui.displayQuickAddOptions()}),$("#emble-interface-default-toggle").on("change",function(e){emble.ui.setting.default_view_emble=$(this).prop("checked"),emble.canvas_api.putEmbleSetting(emble.ui.setting)})},emble.rce.contextMenuManager.addMenuItem=function(e){e.hasOwnProperty("icon")&&e.icon&&e.hasOwnProperty("label")&&e.label&&e.hasOwnProperty("id")&&e.id&&e.hasOwnProperty("onAction")&&e.onAction&&emble.rce.contextMenuManager.menuItem.push(e)},emble.rce.contextMenuManager.calculateMenuPosition=function(e,t){var n=$('.context-menu-wrapper[data-id="'+t+'"]')[0].getBoundingClientRect();emble.rce.contextMenuManager.rect.width=n.width,emble.rce.contextMenuManager.rect.height=n.height;var a=emble.rce.activeEditor.iframeElement.getBoundingClientRect(),o=$(e)[0].getBoundingClientRect(),i=window.scrollY;o.width>=a.width?emble.rce.contextMenuManager.rect.x=a.x+(a.width-emble.rce.contextMenuManager.rect.width)/2:emble.rce.contextMenuManager.rect.x=a.x+o.x+(o.width-emble.rce.contextMenuManager.rect.width)/2,o.y<=50?(emble.rce.contextMenuManager.rect.y=a.y+o.y+i+o.height+emble.rce.contextMenuManager.rect.pointer,emble.rce.contextMenuManager.rect.pointer_position_class="pointer-top"):(emble.rce.contextMenuManager.rect.y=o.y+a.y+i-emble.rce.contextMenuManager.rect.height-emble.rce.contextMenuManager.rect.pointer,emble.rce.contextMenuManager.rect.pointer_position_class="pointer-bottom"),$('.context-menu-wrapper[data-id="'+t+'"]').css({visibility:"visible",left:emble.rce.contextMenuManager.rect.x,top:emble.rce.contextMenuManager.rect.y}),$('.context-menu-wrapper[data-id="'+t+'"]').addClass(emble.rce.contextMenuManager.rect.pointer_position_class)},emble.rce.contextMenuManager.createContextMenu=function(e,t){for(var n='<div class="context-menu-wrapper" style="visibility: hidden;" data-id="'+t+'"><div class="context-menu-inner-wrapper">',a=0;a<e.length;a++)e[a].hasOwnProperty("icon_bg")&&e[a].icon_bg?n+='<button class="'+e[a].id+'"><i class="'+e[a].icon+'" style="background-image: url('+e[a].icon_bg+');"></i><span>'+e[a].label+"</span></button>":n+='<button class="'+e[a].id+'"><i class="'+e[a].icon+'"></i><span>'+e[a].label+"</span></button>",a!=e.length-1&&(n+=" | ");return n+="</div></div>"},emble.rce.contextMenuManager.addMenuItem({icon:"icon-materials-required",label:"Customise",id:"customise",onAction:function(e){emble.rce.customiseManager.displayCustomiseMenu(e.data.context_menu_el)}}),emble.rce.contextMenuManager.addMenuItem({icon:"icon-trash",label:"Delete",id:"delete",onAction:function(e){$(e.data.context_menu_el).replaceWith("<p><br></p>")}}),emble.rce.contextMenuManager.addMenuItem({icon:"icon-Arc icon-Solid",label:"Arc",id:"rce-arc",onAction:function(e){emble.rce.openArc()}}),emble.rce.contextMenuManager.addMenuItem({icon:"mce-ico mce-i-image",label:"Image",id:"rce-img",onAction:function(e){emble.rce.openImg()}}),emble.rce.contextMenuManager.addMenuItem({icon:"mce-ico mce-i-none",icon_bg:"https://www.edu-apps.org/assets/lti_public_resources/youtube_icon.png",label:"YouTube",id:"rce-youtube",onAction:function(e){emble.rce.openYoutube()}}),emble.rce.contextMenuManager.addMenuItem({icon:"mce-ico mce-i-link",label:"Link to URL",id:"rce-link",onAction:function(e){emble.rce.openLink()}}),emble.rce.contextMenuManager.deleteMenuItem=function(e){for(var t=emble.rce.contextMenuManager.menuItem,n=0;n<t.length;n++)e==t[n].id&&t.splic(n,i)},emble.rce.contextMenuManager.destroyContextMenu=function(){var e=emble.rce.activeEditor;$(e.dom.select("[context-menu]")).removeAttr("id"),$(".context-menu-wrapper").remove(),$(window).off("scroll",emble.rce.contextMenuManager.destroyContextMenu),$(e.getWin()).off("scroll",emble.rce.contextMenuManager.destroyContextMenu)},emble.rce.contextMenuManager.displayContextMenu=function(e){var t=emble.rce.activeEditor,n=t.dom.getParents(e,"[data-context-menu]");if($(".context-menu-wrapper").length&&(t.dom.removeClass(t.dom.select("[data-context-menu]"),"selected"),emble.rce.contextMenuManager.destroyContextMenu()),$(e).attr("data-context-menu")||n.length&&$(n).attr("data-context-menu")){var a,o="emble-customise-"+emble.rce.generateUUID();a=$(e).attr("data-context-menu")?e:n[0],$(a).addClass("selected"),$(a).attr("id",o);for(var i=$(a).attr("data-context-menu").split(" "),c=emble.rce.contextMenuManager.menuItem,l=[],r=0;r<i.length;r++)for(var s=0;s<c.length;s++)i[r]==c[s].id&&l.push(c[s]);$("body").append(emble.rce.contextMenuManager.createContextMenu(l,o)),emble.rce.contextMenuManager.calculateMenuPosition(a,o),emble.rce.contextMenuManager.eventToRemove();for(var d=0;d<l.length;d++)$(".context-menu-wrapper button."+l[d].id).one("click",{context_menu_el:a},l[d].onAction),$(".context-menu-wrapper button."+l[d].id).one("click",emble.rce.contextMenuManager.destroyContextMenu)}else t.dom.removeClass(t.dom.select("[data-context-menu]"),"selected"),emble.rce.contextMenuManager.destroyContextMenu()},emble.rce.contextMenuManager.eventToRemove=function(){$(window).scroll(emble.rce.contextMenuManager.destroyContextMenu),$(emble.rce.activeEditor.getWin()).scroll(emble.rce.contextMenuManager.destroyContextMenu),$(".switch_views").live("click",function(){emble.rce.contextMenuManager.destroyContextMenu()})},emble.rce.deleteManager.preventDelete=function(e){var t,n=emble.rce.activeEditor,a=n.selection.getNode(),o=n.dom.getParents(a,"[data-deletable]");if($(a).attr("data-deletable")?t=a:$(o).attr("data-deletable")&&(t=o),$(t).attr("data-deletable")&&"false"==$(t).attr("data-deletable")&&""==$(t).text())return $(t).addClass("highlight-warning-indicator"),setTimeout(function(){$(t).removeClass("highlight-warning-indicator"),0==$(t)[0].classList.length&&$(t).removeAttr("class")},500),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation(),!1},emble.rce.deleteManager.setDeletable=function(){var e=emble.rce.activeEditor.getBody();$(e).children("p").removeAttr("data-deletable");var t=$(e).children().last();t.is("p")&&t.attr("data-deletable",!1)},emble.rce.customiseManager.addCustomiseItem=function(e){e.hasOwnProperty("target_element")&&e.target_element&&e.hasOwnProperty("label")&&e.label&&e.hasOwnProperty("id")&&e.id&&e.hasOwnProperty("option")&&e.option&&emble.rce.customiseManager.customiseItem.push(e)},emble.rce.customiseManager.createCustomiseItem=function(e,t){for(var n=emble.rce.activeEditor,a=$(e).attr("id"),o='<fieldset><legend>Preview changes</legend><div class="preview-container">'+$(e)[0].outerHTML+"</div></fieldset>",i='<fieldset><legend>Customise options</legend><div class="customise-option-container bootstrap-form form-horizontal">',c=0;c<t.length;c++){var l=t[c].option;if(t[c].hasOwnProperty("custom_option")&&0<t[c].custom_option.length&&(l=t[c].custom_option),i+='<div class="control-group">',i+='<label class="control-label">'+t[c].label+"</label>",i+='<div class="controls">',"display-checkbox"==t[c].option_type){i+='<div class="display-checkbox-container">';for(var r=0;r<l.length;r++){d=$(n.dom.select("#"+a+"[data-context-menu]")).is(t[c].target_element)?(m="#"+a+"[data-context-menu]",n.dom.select(m)):(m="#"+a+"[data-context-menu] "+t[c].target_element,n.dom.select("#"+a+"[data-context-menu] "+t[c].target_element));var s="has-border";l[r].class.match(/(border-)[a-z]{1,}/gi)&&(s=""),$(d).hasClass(l[r].class)?i+='<div class="display-checkbox-option selected '+s+" "+l[r].class+'" data-option-group="'+t[c].id+'" data-option="'+l[r].class+'" data-target="'+m+'">':i+='<div class="display-checkbox-option '+s+" "+l[r].class+'" data-option-group="'+t[c].id+'" data-option="'+l[r].class+'" data-target="'+m+'">',"icon"==t[c].id?l[r].name?i+='<i class="icon '+l[r].class+'"></i><span>'+l[r].name+"</span>":i+='<i class="icon '+l[r].class+'"></i><span>'+l[r].class+"</span>":l[r].name?i+="<p>"+l[r].name+"</p>":i+="<p>"+l[r].class+"</p>",i+="</div>"}i+="</div>"}else{i+='<select class="input-xlarge" name="'+t[c].id+'" data-option-group="'+t[c].id+'" data-target="'+t[c].target_element+'">';for(r=0;r<l.length;r++){var d,m;d=$(n.dom.select("#"+a+"[data-context-menu]")).is(t[c].target_element)?(m="#"+a+"[data-context-menu]",n.dom.select(m)):(m="#"+a+"[data-context-menu] "+t[c].target_element,n.dom.select("#"+a+"[data-context-menu] "+t[c].target_element)),$(d).hasClass(l[r].class)?i+='<option value="'+l[r].class+'" selected>':i+='<option value="'+l[r].class+'">',l[r].hasOwnProperty("name")&&l[r].name?i+=l[r].name+"</option>":i+=l[r].class+"</option>"}i+="</select>"}i+="</div>",i+="</div>"}return o+(i+="</div></fieldset>")},emble.rce.customiseManager.addCustomiseItem({label:"Button theme",id:"button-theme",target_element:"[class^=btn]",option_type:"display-checkbox",option:[{name:"Default",class:"btn-default"},{name:"Primary",class:"btn-primary"},{name:"Secondary",class:"btn-secondary"},{name:"Warning",class:"btn-warning"},{name:"Danger",class:"btn-danger"},{name:"Success",class:"btn-success"},{name:"Info",class:"btn-info"}]}),emble.rce.customiseManager.addCustomiseItem({label:"Icon",id:"icon",target_element:"i[class*=icon-]",option_type:"display-checkbox",option:[{name:"None",class:"icon-none"},{name:"Calculator",class:"icon-calculator"},{name:"Download",class:"icon-circle-arrow-down"},{name:"Cloud Download",class:"icon-cloud-download"},{name:"External Link",class:"icon-external-link"},{name:"Check",class:"icon-check"},{name:"Image",class:"icon-image"},{name:"Add",class:"icon-add"},{name:"Book",class:"icon-courses"},{name:"Gradebook",class:"icon-gradebook"},{name:"Media",class:"icon-attach-media"},{name:"Video",class:"icon-video"},{name:"Pencil",class:"icon-edit"},{name:"Document",class:"icon-document"},{name:"PDF",class:"icon-pdf"},{name:"Audio",class:"icon-audio"},{name:"Announcement",class:"icon-announcement"},{name:"Go",class:"icon-arrow-end"},{name:"Assignment",class:"icon-assignment"},{name:"Calendar",class:"icon-calendar-month"},{name:"Chat",class:"icon-chat"},{name:"Comment",class:"icon-comment"},{name:"Group",class:"icon-group"}]}),emble.rce.customiseManager.addCustomiseItem({label:"Column number",id:"column-number",target_element:"div[class*=col-]",option_type:"dropdown",option:[{name:"One",class:"col-md-12 col-lg-12"},{name:"Two",class:"col-md-6 col-lg-6"},{name:"Three",class:"col-md-4 col-lg-4"},{name:"Four",class:"col-md-3 col-lg-3"}]}),emble.rce.customiseManager.addCustomiseItem({label:"Column theme",id:"column-theme",target_element:"div[class*=col-]",option_type:"display-checkbox",option:[{name:"Transparent",class:"bg-transparent"},{name:"Grey",class:"bg-light-grey border-grey border-solid border-xs text-dark-grey rounded-md"}]}),emble.rce.customiseManager.addCustomiseItem({label:"Theme",id:"studios-theme",target_element:"[data-context-menu]",option_type:"display-checkbox",option:[{name:"RMIT",class:"rmit"},{name:"Em Dash",class:"emdash"},{name:"Spicy",class:"spicy"},{name:"Hipster",class:"hipster"},{name:"Tramlines",class:"tramlines"}]}),emble.rce.customiseManager.displayCustomiseMenu=function(e){var t=$(e).attr("id");if($(e).attr("contenteditable",!0),$(e).attr("data-customise")){for(var n=$(e).attr("data-customise").split(" "),a=[],o=0;o<n.length;o++){var i=emble.rce.customiseManager.customiseItem;e:for(var c=0;c<i.length;c++){if(n[o]==i[c].id){var l=JSON.parse(JSON.stringify(i[c]));if($(e).attr("data-"+n[o])){var r=$(e).attr("data-"+n[o]).split(" ");l.custom_option=[];for(var s=0;s<r.length;s++){var d=i[c].option;t:for(var m=0;m<d.length;m++){if(r[s]==d[m].class){l.custom_option.push({name:d[m].name,class:r[s]});break t}m==d.length-1&&l.custom_option.push({class:r[s]})}}}a.push(l);break e}if(n[o]!=i[c].id&&c==i.length-1&&$(e).attr("data-"+n[o])){var u=n[o].replace(/-/g," "),b={label:u.charAt(0).toUpperCase()+u.slice(1),id:n[o],target_element:"#"+t+"[data-context-menu]",custom_option:[]};for(r=$(e).attr("data-"+n[o]).split(" "),s=0;s<r.length;s++)b.custom_option.push({class:r[s]});a.push(b)}}}var g=emble.rce.customiseManager.createCustomiseItem(e,a);emble.ui.displayDialog("Customise",g,"Update",function(e){var t=emble.rce.activeEditor;$(t.dom.select("#"+e+"[data-context-menu]")).replaceWith($(".preview-container").html()),emble.rce.contextMenuManager.destroyContextMenu()},t),emble.rce.customiseManager.handleCustomise()}},emble.rce.customiseManager.handleCustomise=function(){$(".customise-option-container .display-checkbox-option").off("click"),$(".customise-option-container .display-checkbox-option").on("click",function(){var e=$(this).attr("data-option-group"),a=$(this).attr("data-option"),o=$(this).attr("data-target");$('.display-checkbox-option[data-option-group="'+e+'"]').removeClass("selected"),$(this).addClass("selected"),$(".preview-container "+o).addClass(a),$('.display-checkbox-option[data-option-group="'+e+'"]').each(function(){for(var e=$(this).attr("data-option").split(" "),t=0;t<e.length;t++){var n=new RegExp(e[t],"gi");a.match(n)||$(".preview-container "+o).removeClass(e[t])}})});var r=[];$(".preview-container div[class*=col-]").length&&$(".preview-container div[class*=col-]").each(function(){r.push($(this).html())}),$(".customise-option-container select").off("change"),$(".customise-option-container select").on("change",function(){var e=$(this).attr("data-option-group"),a=$(this).val(),o=$(this).attr("data-target");if("column-number"==e){var t,n='<div class="'+$(".preview-container "+o).first().attr("class")+'" data-edit-indicator="false"><p>Column</p></div>',i=$(".preview-container "+o).length;if("col-md-12 col-lg-12"==a?t=1:"col-md-6 col-lg-6"==a?t=2:"col-md-4 col-lg-4"==a?t=3:"col-md-3 col-lg-3"==a&&(t=4),i<t)for(var c=t-i,l=0;l<c;l++)$(".preview-container "+o).parent().append(n);else if(t<i)for(c=i-t,l=0;l<c;l++)$(".preview-container "+o).last().remove();$(".preview-container "+o).each(function(e){r[e]&&$(this).html(r[e])})}$(".preview-container "+o).addClass(a),$('.customise-option-container select[data-option-group="'+e+'"] option').each(function(){for(var e=$(this).attr("value").split(" "),t=0;t<e.length;t++){var n=new RegExp(e[t],"gi");a.match(n)||$(".preview-container "+o).removeClass(e[t])}})}),$(".preview-container a").length&&$(".preview-container a").on("click",function(e){e.preventDefault()})},emble.rce.openArc=function(){$('.mce-btn[aria-label="More external tools"]').click(),$('img[data-tool-id="38"]').click()},emble.rce.openImg=function(){$('.mce-widget.mce-btn[aria-label*="image"] button[id^=mceu] .mce-i-image').click()},emble.rce.openLink=function(){$('.mce-widget.mce-btn[aria-label*="Link to URL"] button[id^=mceu]').click()},emble.rce.openYoutube=function(){$('.mce-widget.mce-btn.mce-instructure_external_tool_button[aria-label*="YouTube"] button[id^=mceu]').click()},emble.rce.undoManager.displayBtn=function(){$(".mce-top-part.mce-container").after('<button class="rce-undo"><i class="icon-reply"></i> Undo</button><button class="rce-redo"><i class="icon-forward"></i> Redo</button>'),emble.rce.undoManager.updateBtnState(),$("button.rce-undo").on("click",function(e){e.preventDefault(),emble.rce.undoManager.undo()}),$("button.rce-redo").on("click",function(e){e.preventDefault(),emble.rce.undoManager.redo()})},emble.rce.undoManager.redo=function(){emble.rce.activeEditor.undoManager.redo(),emble.rce.undoManager.updateBtnState()},emble.rce.undoManager.undo=function(){emble.rce.activeEditor.undoManager.undo(),emble.rce.undoManager.updateBtnState()},emble.rce.undoManager.updateBtnState=function(){var e=emble.rce.activeEditor;e.undoManager.hasUndo()?$("button.rce-undo").removeClass("disabled"):$("button.rce-undo").addClass("disabled"),e.undoManager.hasRedo()?$("button.rce-redo").removeClass("disabled"):$("button.rce-redo").addClass("disabled")},window.location.pathname.match(/(quizzes)\/[0-9]{1,}\/(edit)$/gi)||window.location.pathname.match(/(quizzes)\/[0-9]{1,}\/(new)$/gi)||window.location.pathname.match(/(discussion_topics)\/(new)$/gi)||window.location.pathname.match(/(discussion_topics)\/[0-9]{1,}\/(edit)$/gi)||window.location.pathname.match(/(assignments)\/(new)$/gi)||window.location.pathname.match(/(assignments)\/[0-9]{1,}\/(edit)$/gi)||window.location.pathname.match(/(pages)\/.{1,}\/(edit)$/gi)?initEmble():window.location.pathname.match(/(pages)\/?$/gi)?$("a.new_page").live("click",function(){initEmble()}):window.location.pathname.match(/(syllabus)\/?$/gi)&&$("a.edit_syllabus_link").live("click",function(){initEmble()});